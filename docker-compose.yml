version: "3.9"

services:
  backend:
    build:
      context: .           # vÃ¬ Dockerfile náº±m trong server/
      dockerfile: Dockerfile
    container_name: smartnewsai_backend
    env_file:
      - .env            # ðŸ‘ˆ file .env náº±m á»Ÿ ngoÃ i thÆ° má»¥c server
    ports:
      - "8000:8000"
    volumes:
      - ./server:/app/server            # mount toÃ n bá»™ server/ vÃ o container /app
    command: >
      bash -lc "uvicorn server.main:app --host 0.0.0.0 --port 8000 --reload"
  n8n:
    image: n8nio/n8n:latest
    container_name: smartnewsai_n8n
    ports:
      - "5680:5678"                     # truy cáº­p n8n qua http://localhost:5678
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=${N8N_USER}         # tá»« file .env
      - N8N_BASIC_AUTH_PASSWORD=${N8N_PASSWORD} # tá»« file .env
      - N8N_HOST=localhost
      - N8N_PORT=5678
      - N8N_PROTOCOL=http
    volumes:
      - ./n8n_data:/home/node/.n8n      # nÆ¡i lÆ°u workflow, credentials,...
    restart: always